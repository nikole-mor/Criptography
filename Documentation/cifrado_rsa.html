<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentación</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="sidebar">
        <h1>Seguridad de Datos en <span class="cpp-title">C++</span> y <span class="py-title">Python</span></h1>
        <h2>Documentación</h2>
        <ul>
            <li>
                <button class="dropdown-btn">
                    Inicio 
                    <span class="arrow">▼</span>
                </button>
                <ul class="dropdown-content">
                    <li><a href="index.html#introduccion">Introducción</a></li>
                    <li><a href="index.html#objetivos">Objetivos</a></li>
                    <li><a href="index.html#estructura">Estructura del proyecto</a></li>
                </ul>
            </li>
          <li>
            <button class="dropdown-btn">
                Cifrado C++ 
                <span class="arrow">▼</span>
            </button>
            <ul class="dropdown-content">
                <li><a href="cifrado.html">Cifrado César</a></li>
                <li><a href="enmascarado.html">Enmascarado</a></li>
                <li><a href="tokenizado.html">Tokenizado</a></li>
                <li><a href="truncado.html">Truncado</a></li>
                <li><a href="utilidades.html">Utilidades</a></li>
            </ul>
        </li>
        <li>
          <button class="dropdown-btn">
              Cifrado RSA Python 
              <span class="arrow">▼</span>
          </button>
          <ul class="dropdown-content">
              <li><a href="cifrado_rsa.html">Cifrado RSA</a></li>
          </ul>
      </li>
        </li>
            <li><a href="index.html#uso">Guía de Uso</a></li>
            <li><a href="index.html##referencias">Referencias</a></li>
      </ul>
      
    </div>
    <div class="main-content">
        <header>
            <h1>Soluciones de Seguridad de Datos en C++ y Python</h1>
        </header>
        <button class="inicio"><a href="index.html">Inicio</a></button>
        <section id="modulo-cifrado-python">
            <h2>Cifrado con Llave RSA en Python</h2>
            <p>El cifrado con llave RSA es un método de cifrado asimétrico que utiliza una llave pública para cifrar y una llave privada para descifrar. A continuación se muestra un ejemplo de cifrado con llave RSA en Python:</p>
            <h3>Cifrado</h3>
<pre><code><span class="hljs-comment"># Librerías de Crypto</span>
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP

<span class="hljs-comment"># Abre el archivo que contiene la llave pública y la carga</span>
def cargar_llave_rsa(file_path):
    with open(file_path, 'rb') as file:
        key = RSA.import_key(file.read())
    return key

<span class="hljs-comment"># Lee el archivo y cifra el contenido con la llave pública</span>
def cifrar_archivo_rsa(archivo_path, llave_publica_path, output_path):
    with open(archivo_path, 'rb') as file:
        archivo_data = file.read()

    llave_publica = cargar_llave_rsa(llave_publica_path)
    cifrador = PKCS1_OAEP.new(llave_publica)
    archivo_cifrada = cifrador.encrypt(archivo_data)

    with open(output_path, 'wb') as file:
        file.write(archivo_cifrada)

<span class="hljs-comment"># Ruta de archivo a cifrar</span>
mensaje_path = 'mensaje.txt'

<span class="hljs-comment"># Ruta para crear archivo cifrado</span>x
llave_publica_path = '../llaves/llave_publica_diego.pem'

<span class="hljs-comment"># Ruta para crear archivo cifrado</span>
output_path = 'archivo_cifrado.bin'

cifrar_archivo_rsa(mensaje_path, llave_publica_path, output_path)
</code></pre>
            <h3>Resultado</h3>
            <p>Al cifrar un archivo con la llave pública, se debe generar un archivo.bin cuyo contenido no puede ser interpretado.</p>

            <h3>Descifrado</h3>
<pre><code><span class="hljs-comment"># Librerías de Crypto</span>
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP

<span class="hljs-comment"># Abre el archivo que contiene la llave pública y la carga</span>
def cargar_llave_rsa(file_path):
    with open(file_path, 'rb') as file:
        key = RSA.import_key(file.read())
    return key

<span class="hljs-comment"># Lee el archivo cifrado y descifra el contenido con la llave privada</span>
def desencriptar_archivo_rsa(archivo_cifrada_path, llave_privada_path, output_path):
    with open(archivo_cifrada_path, 'rb') as file:
        archivo_cifrada = file.read()

    llave_privada = cargar_llave_rsa(llave_privada_path)
    descifrador = PKCS1_OAEP.new(llave_privada)
    archivo_descifrada = descifrador.decrypt(archivo_cifrada)

    with open(output_path, 'wb') as file:
        file.write(archivo_descifrada)

<span class="hljs-comment"># Ruta de archivo cifrado</span>
archivo_cifrada_path = 'menseje_cifrada.bin'

<span class="hljs-comment"># Ruta de llave privada</span>
llave_privada_path = '../llaves/llave_privada.pem'

<span class="hljs-comment"># Ruta para crear archivo descifrado</span>
output_path = 'archivo_descifrada.txt'

desencriptar_archivo_rsa(archivo_cifrada_path, llave_privada_path, output_path)
</code></pre>
            <h3>Resultado</h3>
            <p>Al cifrar con una llave pública y descifrar con una privada se debe recuperar el contenido original del archivo.</p>
<pre>
archivo_descifrado.txt:
Mensaje descifrado
</pre>
        </section>

    </div>
    <script src="script.js"></script>
</body>
</html>
